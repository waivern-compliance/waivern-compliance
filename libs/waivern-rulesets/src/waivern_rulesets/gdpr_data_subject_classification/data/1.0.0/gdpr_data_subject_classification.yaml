# GDPR Data Subject Classification Ruleset
# Maps data subject indicators to GDPR classifications

name: "gdpr_data_subject_classification"
version: "1.0.0"
description: "Maps data subject indicators to GDPR classification"

# Default article references applicable to all data subjects
default_article_references:
  - "Article 4(1)"
  - "Article 30(1)(c)"

# Master list of valid data subject categories (for reporting/governance)
data_subject_categories:
  - "employee"
  - "job_applicant"
  - "customer"
  - "visitor"
  - "healthcare"
  - "education"
  - "financial"
  - "business_partner"

# Valid indicator categories (from data_subject_indicator ruleset)
indicator_categories:
  - employee
  - former_employee
  - job_applicant
  - contractor
  - director
  - customer
  - prospect
  - former_customer
  - visitor
  - subscriber
  - supplier
  - advisor
  - partner
  - patient
  - provider
  - student
  - guardian
  - account_holder
  - beneficiary

rules:
  # =============================================================================
  # Employment-Related Data Subjects
  # =============================================================================

  - name: "Employees"
    description: "Current and former employees, contractors, and directors"
    data_subject_category: "employee"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
      - "Article 30(1)(c)"
    typical_lawful_bases:
      - "contract"
      - "legal_obligation"
    indicator_categories:
      - employee
      - former_employee
      - contractor
      - director

  - name: "Job Applicants"
    description: "Candidates and job seekers in recruitment process"
    data_subject_category: "job_applicant"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
    typical_lawful_bases:
      - "consent"
      - "contract"
    indicator_categories:
      - job_applicant

  # =============================================================================
  # Customer-Related Data Subjects
  # =============================================================================

  - name: "Customers"
    description: "Current, former, and prospective customers"
    data_subject_category: "customer"
    article_references:
      - "Article 4(1)"
      - "Article 6"
    typical_lawful_bases:
      - "contract"
      - "legitimate_interests"
    indicator_categories:
      - customer
      - former_customer
      - prospect

  - name: "Subscribers"
    description: "Newsletter and marketing subscribers"
    data_subject_category: "customer"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(a)"
      - "Article 7"
    typical_lawful_bases:
      - "consent"
    indicator_categories:
      - subscriber

  # =============================================================================
  # Visitor and Anonymous Data Subjects
  # =============================================================================

  - name: "Visitors"
    description: "Website visitors and anonymous users"
    data_subject_category: "visitor"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(f)"
      - "Recital 47"
    typical_lawful_bases:
      - "legitimate_interests"
      - "consent"
    indicator_categories:
      - visitor

  # =============================================================================
  # Healthcare Data Subjects
  # =============================================================================

  - name: "Patients"
    description: "Healthcare patients and service recipients"
    data_subject_category: "healthcare"
    article_references:
      - "Article 4(1)"
      - "Article 9(2)(h)"
      - "Article 30(1)(c)"
    typical_lawful_bases:
      - "vital_interests"
      - "public_task"
      - "consent"
    indicator_categories:
      - patient

  - name: "Healthcare Providers"
    description: "Medical professionals and healthcare workers"
    data_subject_category: "healthcare"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
    typical_lawful_bases:
      - "contract"
      - "legal_obligation"
    indicator_categories:
      - provider

  # =============================================================================
  # Education Data Subjects
  # =============================================================================

  - name: "Students"
    description: "Students and educational service recipients"
    data_subject_category: "education"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
      - "Article 8"
    typical_lawful_bases:
      - "contract"
      - "public_task"
    indicator_categories:
      - student

  - name: "Guardians"
    description: "Parents and legal guardians"
    data_subject_category: "education"
    article_references:
      - "Article 4(1)"
      - "Article 8"
    typical_lawful_bases:
      - "consent"
      - "contract"
    indicator_categories:
      - guardian

  # =============================================================================
  # Financial Data Subjects
  # =============================================================================

  - name: "Account Holders"
    description: "Financial account holders and banking customers"
    data_subject_category: "financial"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
      - "Article 32"
    typical_lawful_bases:
      - "contract"
      - "legal_obligation"
    indicator_categories:
      - account_holder

  - name: "Beneficiaries"
    description: "Insurance and pension beneficiaries"
    data_subject_category: "financial"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
    typical_lawful_bases:
      - "contract"
      - "legal_obligation"
    indicator_categories:
      - beneficiary

  # =============================================================================
  # Business Partner Data Subjects
  # =============================================================================

  - name: "Suppliers"
    description: "Vendors and supplier contacts"
    data_subject_category: "business_partner"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
    typical_lawful_bases:
      - "contract"
      - "legitimate_interests"
    indicator_categories:
      - supplier

  - name: "Advisors"
    description: "Professional advisors and consultants"
    data_subject_category: "business_partner"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
    typical_lawful_bases:
      - "contract"
    indicator_categories:
      - advisor

  - name: "Partners"
    description: "Business and strategic partners"
    data_subject_category: "business_partner"
    article_references:
      - "Article 4(1)"
      - "Article 6(1)(b)"
      - "Article 6(1)(f)"
    typical_lawful_bases:
      - "contract"
      - "legitimate_interests"
    indicator_categories:
      - partner

# =============================================================================
# Risk Modifiers
# =============================================================================
# Uses the same pattern structure as detection rules:
# - patterns: Word boundary matching (case-insensitive)
# - value_patterns: Regex matching for complex patterns
# =============================================================================

risk_modifiers:
  risk_increasing:
    - patterns:
        - minor
        - child
      value_patterns:
        - "under.*years"
      modifier: "minor"
      article_references:
        - "Article 8"

    - patterns:
        - vulnerable
      modifier: "vulnerable_individual"
      article_references:
        - "Recital 75"

    - patterns:
        - patient
      modifier: "health_related"
      article_references:
        - "Article 9"

    - patterns:
        - union_member
        - union
        - guild
        - guild_member
      modifier: "union_related"
      article_references:
        - "Article 9"

    - patterns:
        - heterosexual
        - homosexual
        - trans
        - bisexual
        - straight
        - queer
        - gay
        - transsexual
      modifier: "sexuality_related"
      article_references:
        - "Article 9"

    - patterns:
        - labour
        - conservative
        - reform
        - liberal_democrat
        - green
        - democrat
        - republican
        - socialist
        - communist
        - party
        - SDLP
        - unionist
        - coalition
        - sinn_fein
        - scottish_national_party
        - plaid_cymru
      modifier: "party_membership_related"
      article_references:
        - "Article 9"

    - patterns:
        - white
        - caucasian
        - european
        - white_british
        - white_irish
        - white_other
        - black
        - african
        - caribbean
        - black_british
        - black_african
        - black_caribbean
        - asian
        - south_asian
        - east_asian
        - southeast_asian
        - chinese
        - indian
        - pakistani
        - bangladeshi
        - filipino
        - vietnamese
        - korean
        - japanese
        - arab
        - middle_eastern
        - hispanic
        - latino
        - latina
        - latinx
        - native_american
        - indigenous
        - aboriginal
        - first_nations
        - inuit
        - metis
        - pacific_islander
        - polynesian
        - maori
        - mixed
        - mixed_race
        - multiracial
        - biracial
      modifier: "ethnic_group_related"
      article_references:
        - "Article 9"

    - patterns:
        - christianity
        - christian
        - catholic
        - protestant
        - orthodox
        - anglican
        - baptist
        - methodist
        - lutheran
        - presbyterian
        - evangelical
        - pentecostal
        - mormon
        - jehovah_witness
        - seventh_day_adventist
        - islam
        - muslim
        - sunni
        - shia
        - sufi
        - judaism
        - jewish
        - orthodox_jewish
        - reform_jewish
        - conservative_jewish
        - hinduism
        - hindu
        - buddhism
        - buddhist
        - sikhism
        - sikh
        - jainism
        - jain
        - zoroastrianism
        - zoroastrian
        - bahai
        - shinto
        - taoism
        - taoist
        - confucianism
        - paganism
        - pagan
        - wicca
        - druid
        - rastafarian
        - scientology
        - atheism
        - atheist
        - agnostic
        - agnosticism
        - humanism
        - humanist
        - secularism
        - secular
        - rationalism
        - rationalist
        - no_religion
        - non_religious
        - irreligious
        - spiritual_but_not_religious
        - free_thinker
        - ethical_culture
        - unitarian
        - universalist
        - other_religion
        - prefer_not_to_say
        - declined
        - unknown
      modifier: "religious_belief_related"
      article_references:
        - "Article 9"

    - patterns:
        - veganism
        - vegan
        - vegetarianism
        - pacifism
        - pacifist
        - feminism
        - feminist
        - environmentalism
        - anti_capitalism
        - socialism
        - socialist
        - communism
        - libertarianism
        - anarchism
        - political_belief
        - ethical_veganism
        - animal_rights
        - conscientious_objection
        - philosophical_veganism
      modifier: "philosophical_belief_related"
      article_references:
        - "Article 9"

    - patterns:
        - fingerprint_id
        - face_template_id
        - iris_data
        - voice_sample
        - biometric_hash
        - genetic_sample_id
        - dna_profile_id
        - genome_data
        - genetic_test_result
        - biometric_image
        - facial_vector
        - fingerprint_minutiae
        - iris_code
        - voice_signature
        - genetic_sequence
        - genomic_file
        - biometric_feature_vector
      modifier: "biometric_data"
      article_references:
        - "Article 9"

    - patterns:
        - vcf_file
        - fasta
        - fastq
        - bam_file
        - genetic_sample
        - dna_sample
        - genetic_report
        - test_result_genetic
        - genomic_sequence
        - nucleotide
        - base_pair
        - snp
        - genetic_variant
        - hereditary_condition
        - family_medical_history
        - inherited_condition
        - genetic_disorder
      modifier: "genetic_data"
      article_references:
        - "Article 9"

  risk_decreasing:
    - patterns:
        - non-EU
      value_patterns:
        - "third.country"
      modifier: "non_eu_resident"
      article_references:
        - "Article 3"
