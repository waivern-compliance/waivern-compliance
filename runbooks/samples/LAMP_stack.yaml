name: "Sample Runbook for LAMP Stack"
description: >
  Analyze database and source code for potentially sensitive information and processing purposes.

connectors:
  - name: my_mysql_db
    type: mysql
    properties:
      # MySQL credentials are first tried from environment variables:
      # MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE, MYSQL_PORT
      # You can also specify them here, but environment variables
      # take precedence and are recommended for security reasons
      max_rows_per_table: 5
  - name: "php_source_code"
    type: "source_code"
    properties:
      path: "./tests/wct/analysers/personal_data_analyser/source_code_mock_php"
      language: "php"
      file_patterns: ["**/*.php"]
      max_file_size: 10485760  # 10MB
      max_files: 30  # Allow up to 30 files (we have 25)
      analysis_depth: "detailed"

analysers:
  - name: "personal_data_analyser_for_mysql"
    type: "personal_data_analyser"
    properties:
      evidence_context_size: long
      enable_llm_validation: false
      llm_batch_size: 80
      llm_validation_mode: conservative  # More careful validation for database content
      # Analysers always have a default ruleset to use.
      # However, you can specify a custom one if so desired.
      # The custom ruleset must follow the same structure as the default one.
      ruleset_name: "personal_data"
  - name: "personal_data_analyser_for_source_code"
    type: "personal_data_analyser"
    properties:
      evidence_context_size: medium
      enable_llm_validation: false
      llm_batch_size: 50
      llm_validation_mode: standard
    metadata:
      priority: "high"
      description: "Analyze PHP source code for personal data handling patterns"

execution:
  - connector: "my_mysql_db"
    analyser: "personal_data_analyser_for_mysql"
    input_schema_name: "text"
    output_schema_name: "personal_data_analysis_findings"
    context:
      description: "Analyse MySQL database for personal data collection"
      priority: "high"
  - connector: "php_source_code"
    analyser: "personal_data_analyser_for_source_code"
    input_schema_name: "source_code"
    output_schema_name: "personal_data_analysis_findings"
    context:
      description: "Analyze PHP source code for personal data handling patterns"
      priority: "high"
      sensitivity_rules:
        - "function_name_detection"
        - "parameter_name_detection"
        - "class_property_detection"
        - "sql_query_detection"
        - "third_party_integration_detection"
