name: "Sample Runbook"
description: "Analyse files, database, and source code for potentially sensitive information"

connectors:
  - name: "file_reader"
    type: "file_reader"
    properties:
      path: "./tests/wct/connectors/file/sample_file.txt"
  - name: my_mysql_db
    type: mysql
    properties:
      # MySQL credentials are loaded from environment variables:
      # MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE, MYSQL_PORT
      # You can also specify them here, but environment variables take precedence
      max_rows_per_table: 5
  - name: "php_source_code"
    type: "source_code"
    properties:
      path: "./tests/wct/plugins/personal_data_analyser/source_code_mock_php"
      language: "php"
      file_patterns: ["**/*.php"]
      max_file_size: 10485760  # 10MB
      max_files: 30  # Allow up to 30 files (we have 25)
      analysis_depth: "detailed"

plugins:
  - name: "file_content_analyser"
    type: "file_content_analyser"
    properties:
      sensitivity_level: "medium"
    metadata:
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
  - name: "personal_data_analyser_for_file_content"
    type: "personal_data_analyser"
    properties:
      evidence_context_size: full
      enable_llm_validation: false
      llm_batch_size: 50
      llm_validation_mode: standard
    metadata:
      compliance_frameworks: ["GDPR", "CCPA"]
  - name: "personal_data_analyser_for_mysql"
    type: "personal_data_analyser"
    properties:
      evidence_context_size: long
      enable_llm_validation: false
      llm_batch_size: 80
      llm_validation_mode: conservative  # More careful validation for database content
    metadata:
      compliance_frameworks: ["GDPR", "CCPA"]
  - name: "personal_data_analyser_for_source_code"
    type: "personal_data_analyser"
    properties:
      evidence_context_size: medium
      enable_llm_validation: false
      llm_batch_size: 50
      llm_validation_mode: standard
    metadata:
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
      description: "Analyze PHP source code for personal data handling patterns"

execution:
  - connector: "file_reader"
    plugin: "file_content_analyser"
    input_schema_name: "text"
    output_schema_name: "file_content_analysis_result"
    context:
      description: "Analyze file content for sensitive information"
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
      sensitivity_rules:
        - "email_detection"
        - "password_detection"
        - "api_key_detection"
  - connector: "file_reader"
    plugin: "personal_data_analyser_for_file_content"
    input_schema_name: "text"
    output_schema_name: "personal_data_analysis_findings"
    context:
      description: "Analyze file content for personal data"
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
  - connector: "my_mysql_db"
    plugin: "personal_data_analyser_for_mysql"
    input_schema_name: "text"
    output_schema_name: "personal_data_analysis_findings"
    context:
      description: "Analyse MySQL database for personal data"
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
  - connector: "php_source_code"
    plugin: "personal_data_analyser_for_source_code"
    input_schema_name: "source_code"
    output_schema_name: "personal_data_analysis_findings"
    context:
      description: "Analyze PHP source code for personal data handling patterns"
      priority: "high"
      compliance_frameworks: ["GDPR", "CCPA"]
      sensitivity_rules:
        - "function_name_detection"
        - "parameter_name_detection"
        - "class_property_detection"
        - "sql_query_detection"
        - "third_party_integration_detection"
