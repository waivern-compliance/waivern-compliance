name: "Lightweight LAMP Stack Analysis with SQLite"
description: >
  Analyse SQLite database and filesystem for personally sensitive information and processing purposes.
  This runbook provides comprehensive analysis using SQLite instead of MySQL and a lightweight
  filesystem mock for easier testing and development workflows.
contact: "Sarah Johnson (DPO) <sarah.johnson@company.co.uk>"

artifacts:
  # Source artifacts - data extraction from various sources
  sqlite_data:
    name: "SQLite Database Content"
    description: "Extract data from SQLite compliance test database"
    source:
      type: "sqlite"
      properties:
        database_path: "./apps/wct/tests/integration/test_data/sqlite_compliance_test.db"
        max_rows_per_table: 10

  filesystem_data:
    name: "Filesystem Content"
    description: "Read files from filesystem mock"
    source:
      type: "filesystem"
      properties:
        path: "./libs/waivern-filesystem/tests/waivern_filesystem/filesystem_mock_lite"
        exclude_patterns: ["README_lite.md"]
        max_files: 50
        encoding: "utf-8"

  # SQLite analysis artifacts
  sqlite_personal_data:
    name: "Personal Data Detection in SQLite Database"
    description: "Scan SQLite database tables and columns for personally identifiable information"
    contact: "Emily Chen (Database Administrator) <emily.chen@company.co.uk>"
    inputs: sqlite_data
    process:
      type: "personal_data"
      properties:
        pattern_matching:
          ruleset: "personal_data"
          evidence_context_size: "large"
          maximum_evidence_count: 3
        llm_validation:
          enable_llm_validation: false
          llm_batch_size: 80
          llm_validation_mode: "conservative"
    output: true

  sqlite_data_subject:
    name: "Data Subject Classification in SQLite Database"
    description: "Identify data subject categories from database content for GDPR Article 30(1)(c) compliance"
    contact: "Sarah Johnson (DPO) <sarah.johnson@company.co.uk>"
    inputs: sqlite_data
    process:
      type: "data_subject"
      properties:
        pattern_matching:
          ruleset: "data_subjects"
          evidence_context_size: "medium"
          maximum_evidence_count: 3
        llm_validation:
          enable_llm_validation: false
          llm_batch_size: 50
          llm_validation_mode: "conservative"
    output: true

  sqlite_processing_purpose:
    name: "Processing Purpose Analysis of Database Content"
    description: "Identify GDPR and CCPA compliance processing purposes from database content"
    inputs: sqlite_data
    process:
      type: "processing_purpose"
      properties:
        pattern_matching:
          ruleset: "processing_purposes"
          evidence_context_size: "medium"
          maximum_evidence_count: 3
        llm_validation:
          enable_llm_validation: false
          llm_batch_size: 20
          llm_validation_mode: "conservative"
          confidence_threshold: 0.5
    output: true

  # Filesystem analysis artifacts
  filesystem_personal_data:
    name: "Personal Data Detection in Filesystem"
    description: "Scan filesystem mock for personally identifiable information in files"
    contact: "Michael Brown (DevOps) <michael.brown@company.co.uk>"
    inputs: filesystem_data
    process:
      type: "personal_data"
      properties:
        pattern_matching:
          ruleset: "personal_data"
          evidence_context_size: "large"
          maximum_evidence_count: 3
        llm_validation:
          enable_llm_validation: false
          llm_batch_size: 50
          llm_validation_mode: "conservative"
    output: true

  filesystem_processing_purpose:
    name: "Processing Purpose Analysis of Filesystem Content"
    description: "Identify data processing purposes and compliance frameworks from filesystem content"
    inputs: filesystem_data
    process:
      type: "processing_purpose"
      properties:
        pattern_matching:
          ruleset: "processing_purposes"
          evidence_context_size: "medium"
          maximum_evidence_count: 3
        llm_validation:
          enable_llm_validation: false
          llm_batch_size: 30
          llm_validation_mode: "conservative"
          confidence_threshold: 0.5
    output: true
